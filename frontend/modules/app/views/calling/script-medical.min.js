function setFullScreen(){var e=document.documentElement;$("body").hasClass("full-screen")?($("body").removeClass("full-screen"),$("#fullscreen-toggler").removeClass("active"),localStorage.setItem("medical-fullscreen","false"),document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()):($("body").addClass("full-screen"),$("#fullscreen-toggler").addClass("active"),localStorage.setItem("medical-fullscreen","true"),e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen())}function setTabletmode(){var e=$("div.panel-form"),t=$("div.panel-form").find("i:first"),a=e.find("div.panel-body"),n=e.find("div.panel-footer");if("true"==localStorage.getItem("medical-tablet-mode")){a.slideToggle(300),n.slideToggle(200),t.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),e.toggleClass("").toggleClass("panel-collapse"),setTimeout(function(){e.resize(),e.find("[id^=map-]").resize()},50);var l=$("#callingform-service_profile").select2("data")[0].text||"",o=$("#callingform-counter_service").select2("data")[0].text||"";$("div.panel-form .panel-heading-text").html(" | "+l+": "+o),$("#tablet-mode").prop("checked",!0),$("#tab-menu-default,.small-header").css("display","none"),$(".footer-tabs,.call-next-tablet-mode,.text-tablet-mode").css("display",""),$("#tab-watting .panel-body,#tab-calling .panel-body,#tab-hold .panel-body").css("border-top","1px solid #e4e5e7")}else e.hasClass("panel-collapse")&&(a.slideToggle(300),n.slideToggle(200),t.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),e.toggleClass("").toggleClass("panel-collapse"),setTimeout(function(){e.resize(),e.find("[id^=map-]").resize()},50)),$("div.panel-form .panel-heading-text").html("&nbsp;"),$(".footer-tabs,.call-next-tablet-mode,.text-tablet-mode").css("display","none"),$("#tab-menu-default,.small-header").css("display",""),$("#tab-watting .panel-body,#tab-calling .panel-body,#tab-hold .panel-body").css("border-top","0")}Vue.use(Vuex);const{mapActions:mapActions,mapGetters:mapGetters}=Vuex,store=new Vuex.Store({state:{service_profile_id:null,counter_service_id:null},getters:{form:e=>({service_profile_id:e.service_profile_id,counter_service_id:e.counter_service_id})},mutations:{SET_STATE(e,{key:t,value:a}){e[t]=a}},actions:{setState({commit:e},t){e("SET_STATE",t)}},plugins:[createPersistedState({key:"vuex-medical"})]});var app=new Vue({el:"#app",store:store,data:{tbwaiting:null,tbcalling:null,tbhold:null,waitingLoading:!1,callingLoading:!1,holdLoading:!1,modelServiceProfile:null},computed:{...mapGetters({form:"form"})},watch:{form:{handler:function(e,t){},deep:!0}},mounted(){this.$nextTick(function(){$("#counter_service_id").val(this.form.counter_service_id),$("#callingform-service_profile").val(this.form.service_profile_id).trigger("change"),$("#callingform-service_profile").trigger("select2:select"),this.initTableWaiting(),this.initTableCalling(),this.initTableHold()})},methods:{...mapActions({setState:"setState"}),fetchDataServiceProfile:function(){const e=this;$.ajax({method:"GET",url:"/app/calling/service-profile",dataType:"json",data:{id:e.form.service_profile_id},success:function(t){e.modelServiceProfile=t},error:function(e,t,a){Queue.ajaxAlertError(a)}})},initTableWaiting:function(){const e=this;var t=jQuery("#tb-waiting").DataTable({ajax:{url:"/node/api/v1/calling/waiting-list",data:function(t,a){var n=new $.fn.dataTable.Api(a),l=n.page.info(),o={number:l.page+1,size:l.length};return-1!==l.length?$.extend({},t,{page:o,form:e.form}):$.extend({},t,{form:e.form})},type:"POST",complete:function(e,t){}},dom:"<'row'<'col-xs-6'f><'col-xs-6 d-flex justify-content-end'Bl>> <'row'<'col-xs-12'tr>> <'row'<'col-xs-5'i><'col-xs-7'p>>",language:{loadingRecords:"กำลังดำเนินการ...",zeroRecords:"",lengthMenu:"_MENU_",info:"แสดง _START_ ถึง _END_ จาก _TOTAL_ แถว",infoEmpty:"แสดง 0 ถึง 0 จาก 0 แถว",infoFiltered:"(กรองข้อมูล _MAX_ ทุกแถว)",emptyTable:"ไม่พบข้อมูล",oPaginate:{sFirst:"หน้าแรก",sPrevious:"ก่อนหน้า",sNext:"ถัดไป",sLast:"หน้าสุดท้าย"},search:"_INPUT_ ",searchPlaceholder:"ค้นหา..."},pageLength:10,lengthMenu:[[10,25,50,75,100,-1],[10,25,50,75,100,"All"]],autoWidth:!1,deferRender:!0,searchHighlight:!0,responsive:!1,processing:!0,serverSide:!0,drawCallback:function(e){var t=this.api();dtFnc.initConfirm(t);t.data().count()},initComplete:function(){var e=this.api();dtFnc.initResponsive(e)},columns:[{data:null,defaultContent:"",className:"text-center",render:function(e,t,a,n){return n.row+1}},{data:"checkbox",defaultContent:"",className:"dt-center dt-head-nowrap",title:"#",orderable:!1,visible:!1},{data:"q_num",className:"dt-body-center dt-head-nowrap",title:'<i class="fa fa-money"></i> คิว',render:function(e,t,a,n){return`<span class="badge badge-success">${a.q_num}</span>`}},{data:"q_hn",className:"dt-body-center dt-head-nowrap",title:"HN"},{data:"q_qn",className:"dt-body-center dt-head-nowrap",title:"QN"},{data:"pt_name",className:"dt-body-left dt-head-nowrap",title:"ชื่อ"},{data:"service_name",className:"dt-body-left dt-head-nowrap",title:"ประเภท",render:function(e,t,a,n){return 1===a.quickly?"คิวด่วน":a.service_name}},{data:"service_status_name",className:"dt-body-center dt-head-nowrap",title:"สถานะ"},{data:"queue_date",className:"dt-body-center dt-head-nowrap",title:"วันที่",render:function(e,t,a,n){return moment(a.queue_date).format("DD/MM/YYYY")}},{data:"queue_time",className:"dt-body-center dt-head-nowrap",title:"เวลา",render:function(e,t,a,n){return moment(a.queue_time,"HH:mm:ss").format("HH:mm")}},{data:null,defaultContent:"",className:"dt-center dt-nowrap",orderable:!1,title:'<i class="fa fa-cogs"></i> ดำเนินการ',render:function(e,t,a,n){return`<a href="/node/api/v1/calling/call?id=${a.q_ids}" class="btn btn-success btn-calling">เรียกคิว</a>`}}],columnDefs:[{targets:[4,6,7],visible:!1}],buttons:[{extend:"colvis",text:'<i class="glyphicon glyphicon-list"></i> '},{text:'<i class="glyphicon glyphicon-refresh"></i> ',action:function(e,t,a,n){t.ajax.reload()}}],order:[[9,"asc"]]});jQuery("#tb-waiting").on("error.dt",function(e,t,a,n){e.preventDefault(),swal({title:"Error...!",html:"<small>"+n+"</small>",type:"error"})}).on("preXhr.dt",function(t,a,n){e.waitingLoading=!0}).on("xhr.dt",function(t,a,n,l){$(".count-waiting").html(_.get(n,"total",0)),e.waitingLoading=!1}).on("draw.dt",function(){var e=t.page.info();t.column(0,{search:"applied",order:"applied",page:"applied"}).nodes().each(function(t,a){t.innerHTML=a+1+e.start});var a=null,n=t.rows({page:"current"}).nodes(),l=t.columns().nodes();t.column(6,{page:"current"}).data().each(function(e,o){var r=t.rows(o).data();if(a!==e){var s="";1===r[0].quickly&&(e="คิวด่วน",s="warning"),$(n).eq(o).before('<tr class="'+s+'"><td style="text-align: left;font-size:16px" colspan="'+l.length+'">'+e+"</td></tr>"),a=e}})}),this.tbwaiting=t},initTableCalling:function(){const e=this;var t=jQuery("#tb-calling").DataTable({ajax:{url:"/node/api/v1/calling/calling-list",data:function(t){var a=$("#tb-calling").DataTable(),n=a.page.info(),l={number:n.page+1,size:n.length};return-1!==n.length?$.extend({},t,{page:l,form:e.form}):$.extend({},t,{form:e.form})},type:"POST"},dom:"<'row'<'col-xs-6'f><'col-xs-6 d-flex justify-content-end'Bl>> <'row'<'col-xs-12'tr>> <'row'<'col-xs-5'i><'col-xs-7'p>>",language:{loadingRecords:"กำลังดำเนินการ...",zeroRecords:"",lengthMenu:"_MENU_",info:"แสดง _START_ ถึง _END_ จาก _TOTAL_ แถว",infoEmpty:"แสดง 0 ถึง 0 จาก 0 แถว",infoFiltered:"(กรองข้อมูล _MAX_ ทุกแถว)",emptyTable:"ไม่พบข้อมูล",oPaginate:{sFirst:"หน้าแรก",sPrevious:"ก่อนหน้า",sNext:"ถัดไป",sLast:"หน้าสุดท้าย"},search:"_INPUT_ ",searchPlaceholder:"ค้นหา..."},pageLength:10,lengthMenu:[[10,25,50,75,100,-1],[10,25,50,75,100,"All"]],autoWidth:!1,deferRender:!0,searchHighlight:!0,responsive:!1,processing:!0,serverSide:!0,drawCallback:function(e){var t=this.api();dtFnc.initConfirm(t);t.data().count()},initComplete:function(){var e=this.api();dtFnc.initResponsive(e),dtFnc.initColumnIndex(e)},columns:[{data:null,defaultContent:"",className:"dt-center dt-head-nowrap",title:"#",orderable:!1},{data:"q_num",className:"dt-body-center dt-head-nowrap",title:'<i class="fa fa-money"></i> คิว',render:function(e,t,a,n){return`<span class="badge badge-success">${a.q_num}</span>`}},{data:"q_hn",className:"dt-body-center dt-head-nowrap",title:"HN"},{data:"q_qn",className:"dt-body-center dt-head-nowrap",title:"QN"},{data:"pt_name",className:"dt-body-left dt-head-nowrap",title:"ชื่อ"},{data:"service_name",className:"dt-body-left dt-head-nowrap",title:"ประเภท",render:function(e,t,a,n){return 1===a.quickly?"คิวด่วน":a.service_name}},{data:"counterservice_name",className:"dt-body-center dt-head-nowrap",title:"จุดบริการ"},{data:"queue_date",className:"dt-body-center dt-head-nowrap",title:"วันที่",render:function(e,t,a,n){return moment(a.queue_date).format("DD/MM/YYYY")},visible:!1},{data:"queue_time",className:"dt-body-center dt-head-nowrap",title:"เวลา",render:function(e,t,a,n){return moment(a.queue_time,"HH:mm:ss").format("HH:mm")},visible:!1},{data:"call_timestp",className:"dt-body-center dt-head-nowrap",title:"เวลาเรียกคิว",render:function(e,t,a,n){return moment(a.call_timestp,"YYYY-MM-DD HH:mm:ss").format("HH:mm")}},{data:null,defaultContent:"",className:"dt-center dt-nowrap",orderable:!1,title:'<i class="fa fa-cogs"></i> ดำเนินการ',render:function(t,a,n,l){let o="";return 12===n.serviceid&&11!==n.serviceid&&n.countdrug>0&&21!==parseInt(e.form.service_profile_id)&&0===n.total_drug?o=`<a href="/node/api/v1/calling/waiting-pharmacy?id=${n.caller_ids}" class="btn btn-info btn-waiting" title="ส่งห้องยา">ส่งห้องยา</a>`:[11,12,13].includes(n.serviceid)||(o=`<a href="/node/api/v1/calling/waiting-doctor?id=${n.caller_ids}" class="btn btn-info btn-waiting" title="ส่งห้องแพทย์">ส่งห้องแพทย์</a>`),`<a href="/node/api/v1/calling/recall?id=${n.caller_ids}" class="btn btn-success btn-recall">เรียกซ้ำ</a>\n            <a href="/node/api/v1/calling/hold?id=${n.caller_ids}" class="btn btn-warning btn-hold">พักคิว</a>\n            <a href="/node/api/v1/calling/end?id=${n.caller_ids}" class="btn btn-danger btn-end">เสร็จสิ้น</a>\n            ${o}`}}],columnDefs:[{targets:[2,3,5,6,7],visible:!1}],buttons:[{extend:"colvis",text:'<i class="glyphicon glyphicon-list"></i> '},{text:'<i class="glyphicon glyphicon-refresh"></i> ',action:function(e,t,a,n){t.ajax.reload()}}]});jQuery("#tb-calling").on("error.dt",function(e,t,a,n){e.preventDefault(),swal({title:"Error...!",html:"<small>"+n+"</small>",type:"error"})}).on("preXhr.dt",function(t,a,n){e.callingLoading=!0}).on("xhr.dt",function(t,a,n,l){$(".count-calling").html(_.get(n,"total",0)),e.callingLoading=!1}).on("draw.dt",function(){var e=t.page.info();t.column(0,{search:"applied",order:"applied",page:"applied"}).nodes().each(function(t,a){t.innerHTML=a+1+e.start});var a=null,n=t.rows({page:"current"}).nodes(),l=t.columns().nodes();t.column(2,{page:"current"}).data().each(function(e,o){var r=t.rows(o).data();if(a!==e){var s="";1===r[0].quickly&&(e="คิวด่วน",s="warning"),$(n).eq(o).before('<tr class="'+s+'"><td style="text-align: left;font-size:16px" colspan="'+l.length+'">'+e+"</td></tr>"),a=e}})}),e.tbcalling=t},initTableHold:function(){const e=this;var t=jQuery("#tb-hold").DataTable({ajax:{url:"/node/api/v1/calling/hold-list",data:function(t){var a=$("#tb-hold").DataTable(),n=a.page.info(),l={number:n.page+1,size:n.length};return-1!==n.length?$.extend({},t,{page:l,form:e.form}):$.extend({},t,{form:e.form})},type:"POST"},dom:"<'row'<'col-xs-6'f><'col-xs-6 d-flex justify-content-end'Bl>> <'row'<'col-xs-12'tr>> <'row'<'col-xs-5'i><'col-xs-7'p>>",language:{loadingRecords:"กำลังดำเนินการ...",zeroRecords:"",lengthMenu:"_MENU_",info:"แสดง _START_ ถึง _END_ จาก _TOTAL_ แถว",infoEmpty:"แสดง 0 ถึง 0 จาก 0 แถว",infoFiltered:"(กรองข้อมูล _MAX_ ทุกแถว)",emptyTable:"ไม่พบข้อมูล",oPaginate:{sFirst:"หน้าแรก",sPrevious:"ก่อนหน้า",sNext:"ถัดไป",sLast:"หน้าสุดท้าย"},search:"_INPUT_ ",searchPlaceholder:"ค้นหา..."},pageLength:10,lengthMenu:[[10,25,50,75,100,-1],[10,25,50,75,100,"All"]],autoWidth:!1,deferRender:!0,searchHighlight:!0,responsive:!1,processing:!0,serverSide:!0,drawCallback:function(e){var t=this.api();dtFnc.initConfirm(t);t.data().count()},initComplete:function(){var e=this.api();dtFnc.initResponsive(e),dtFnc.initColumnIndex(e)},columns:[{data:null,defaultContent:"",className:"dt-center dt-head-nowrap",title:"#",orderable:!1},{data:"q_num",className:"dt-body-center dt-head-nowrap",title:'<i class="fa fa-money"></i> คิว',render:function(e,t,a,n){return`<span class="badge badge-success">${a.q_num}</span>`}},{data:"q_hn",className:"dt-body-center dt-head-nowrap",title:"HN"},{data:"q_qn",className:"dt-body-center dt-head-nowrap",title:"QN"},{data:"pt_name",className:"dt-body-left dt-head-nowrap",title:"ชื่อ"},{data:"service_name",className:"dt-body-left dt-head-nowrap",title:"ประเภท",render:function(e,t,a,n){return 1===a.quickly?"คิวด่วน":a.service_name}},{data:"counterservice_name",className:"dt-body-center dt-head-nowrap",title:"จุดบริการ"},{data:"queue_date",className:"dt-body-center dt-head-nowrap",title:"วันที่",render:function(e,t,a,n){return moment(a.queue_date).format("DD/MM/YYYY")},visible:!1},{data:"queue_time",className:"dt-body-center dt-head-nowrap",title:"เวลา",render:function(e,t,a,n){return moment(a.queue_time,"HH:mm:ss").format("HH:mm")},visible:!1},{data:"hold_time",className:"dt-body-center dt-head-nowrap",title:"เวลาพักคิว",render:function(e,t,a,n){return moment(a.hold_time,"YYYY-MM-DD HH:mm:ss").format("HH:mm")}},{data:null,defaultContent:"",className:"dt-center dt-nowrap",orderable:!1,title:'<i class="fa fa-cogs"></i> ดำเนินการ',render:function(e,t,a,n){return`<a href="/node/api/v1/calling/recall?id=${a.caller_ids}" class="btn btn-success btn-calling">เรียกคิว</a>\n            <a href="/node/api/v1/calling/end?id=${a.caller_ids}" class="btn btn-danger btn-end">เสร็จสิ้น</a>`}}],columnDefs:[{targets:[2,3,5,6,7],visible:!1}],buttons:[{extend:"colvis",text:'<i class="glyphicon glyphicon-list"></i> '},{text:'<i class="glyphicon glyphicon-refresh"></i> ',action:function(e,t,a,n){t.ajax.reload()}}]});jQuery("#tb-hold").on("error.dt",function(e,t,a,n){e.preventDefault(),swal({title:"Error...!",html:"<small>"+n+"</small>",type:"error"})}).on("preXhr.dt",function(t,a,n){e.holdLoading=!0}).on("xhr.dt",function(t,a,n,l){$(".count-hold").html(_.get(n,"total",0)),e.holdLoading=!1}).on("draw.dt",function(){var e=t.page.info();t.column(0,{search:"applied",order:"applied",page:"applied"}).nodes().each(function(t,a){t.innerHTML=a+1+e.start});var a=null,n=t.rows({page:"current"}).nodes(),l=t.columns().nodes();t.column(2,{page:"current"}).data().each(function(e,o){var r=t.rows(o).data();if(a!==e){var s="";1===r[0].quickly&&(e="คิวด่วน",s="warning"),$(n).eq(o).before('<tr class="'+s+'"><td style="text-align: left;font-size:16px" colspan="'+l.length+'">'+e+"</td></tr>"),a=e}})}),e.tbhold=t}}});$("#callingform-service_profile").on("change",function(e){var t=$(this).val();app.setState({key:"service_profile_id",value:t}),app.fetchDataServiceProfile()}),$("#callingform-counter_service").on("depdrop:change",function(e){var t=$(this).val();app.setState({key:"counter_service_id",value:t})}),$("#callingform-counter_service").on("change",function(e){var t=$(this).val();app.setState({key:"counter_service_id",value:t}),app.tbwaiting&&!app.waitingLoading&&app.tbwaiting.ajax.reload(),app.tbcalling&&!app.callingLoading&&app.tbcalling.ajax.reload()}),$('input[type="search"]').focus(function(){$(this).animate({width:"250px"},400)}),$('input[type="search"]').blur(function(){$(this).animate({width:"160px"},500)}),toastr.options={debug:!1,newestOnTop:!1,positionClass:"toast-top-center",closeButton:!0,toastClass:"animated fadeInDown"},Queue={handleEventClick:function(){var e=this;$("#tb-waiting tbody").on("click","tr td a.btn-calling",function(t){t.preventDefault();var a=$(this).closest("tr"),n=$(this).attr("href");a.hasClass("child")&&void 0===app.tbwaiting.row(a).data()&&(a=$(this).closest("tr").prev());a.data("key");var l=app.tbwaiting.row(a).data(),o=$("#callingform-counter_service").select2("data")[0].text||"";e.checkCounter()&&swal({title:"ยืนยันเรียกคิว "+l.q_num+" ?",text:l.pt_name,html:'<small class="text-danger" style="font-size: 13px;">กด Enter เพื่อยืนยัน / กด Esc เพื่อยกเลิก</small><p>'+o+"</p>",type:"question",input:"radio",showCancelButton:!0,confirmButtonText:"เรียกคิว",cancelButtonText:"ยกเลิก",allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(t){return new Promise(function(a,o){$.ajax({method:"POST",url:n+"&access-token="+accesstoken,dataType:"json",data:{data:l,...app.form},success:function(n){$("li.tab-watting, #tab-watting").removeClass("active"),$("li.tab-calling, #tab-calling").addClass("active"),e.reloadTbWaiting(),e.reloadTbCalling(),e.toastrSuccess("CALL "+l.q_num),socket.emit("call",n),0==t?setTimeout(function(){var t=$("#tb-calling tr#"+n.modelCaller.caller_ids),l="/node/api/v1/calling?id="+n.modelCaller.caller_ids,o=(t.data("key"),app.tbcalling.row(t).data());$.ajax({method:"POST",url:`${l}&access-token=${accesstoken}`,dataType:"json",data:{data:o,...app.form},success:function(t){"200"==t.status?(e.reloadTbCalling(),e.toastrSuccess("END "+o.q_num),socket.emit("finish",t),a()):e.ajaxAlertWarning()},error:function(t,a,n){e.ajaxAlertError(n)}})},500):a()},error:function(t,a,n){e.ajaxAlertError(n)}})})}}).then(e=>{e.value})}),$("#tb-waiting tbody").on("click","tr td a.btn-end",function(t){t.preventDefault();var a=$(this).closest("tr"),n=$(this).attr("href");a.hasClass("child")&&void 0===app.tbwaiting.row(a).data()&&(a=$(this).closest("tr").prev());a.data("key");var l=app.tbwaiting.row(a).data();e.checkCounter()&&swal({title:"ยืนยัน END คิว "+l.q_num+" ?",text:l.pt_name,html:'<small class="text-danger" style="font-size: 13px;">กด Enter เพื่อยืนยัน / กด Esc เพื่อยกเลิก</small>',type:"question",showCancelButton:!0,confirmButtonText:"ยืนยัน",cancelButtonText:"ยกเลิก",allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(t,a){$.ajax({method:"POST",url:baseUrl+n,dataType:"json",data:{data:l,...app.form},success:function(a){200==a.status?(e.reloadTbCalling(),e.reloadTbHold(),e.toastrSuccess("END "+l.q_num),socket.emit("finish",a),t()):e.ajaxAlertWarning()},error:function(t,a,n){e.ajaxAlertError(n)}})})}}).then(e=>{e.value&&swal.close()})}),$("#tb-calling tbody").on("click","tr td a.btn-recall",function(t){t.preventDefault();var a=$(this).closest("tr"),n=$(this).attr("href");a.hasClass("child")&&void 0===app.tbcalling.row(a).data()&&(a=$(this).closest("tr").prev());a.data("key");var l=app.tbcalling.row(a).data(),o=$("#callingform-counter_service").select2("data")[0].text||"";e.checkCounter()&&swal({title:"ยืนยันเรียกคิว "+l.q_num+" ?",text:l.pt_name,html:'<small class="text-danger" style="font-size: 13px;">กด Enter เพื่อยืนยัน / กด Esc เพื่อยกเลิก</small><p>'+o+"</p>",type:"question",showCancelButton:!0,confirmButtonText:"เรียกคิว",cancelButtonText:"ยกเลิก",allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(t,a){$.ajax({method:"POST",url:n+"&access-token="+accesstoken,dataType:"json",data:{data:l,...app.form},success:function(a){200==a.status?(Queue.reloadTbCalling(),e.toastrSuccess("RECALL "+l.q_num),socket.emit("call",a),t()):e.ajaxAlertWarning()},error:function(t,a,n){e.ajaxAlertError(n)}})})}}).then(e=>{e.value&&swal.close()})}),$("#tb-calling tbody").on("click","tr td a.btn-hold",function(t){t.preventDefault();var a=$(this).closest("tr"),n=$(this).attr("href");a.hasClass("child")&&void 0===app.tbcalling.row(a).data()&&(a=$(this).closest("tr").prev());a.data("key");var l=app.tbcalling.row(a).data();e.checkCounter()&&swal({title:"ยืนยันพักคิว "+l.q_num+" ?",text:l.pt_name,html:'<small class="text-danger" style="font-size: 13px;">กด Enter เพื่อยืนยัน / กด Esc เพื่อยกเลิก</small>',type:"question",showCancelButton:!0,confirmButtonText:"พักคิว",cancelButtonText:"ยกเลิก",allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(t,a){$.ajax({method:"POST",url:n+"&access-token="+accesstoken,dataType:"json",data:{data:l,...app.form},success:function(a){200==a.status?(e.reloadTbCalling(),e.reloadTbHold(),e.toastrSuccess("HOLD "+l.q_num),socket.emit("hold",a),t()):e.ajaxAlertWarning()},error:function(t,a,n){e.ajaxAlertError(n)}})})}}).then(e=>{e.value&&swal.close()})}),$("#tb-calling tbody").on("click","tr td a.btn-end",function(t){t.preventDefault();var a=$(this).closest("tr"),n=$(this).attr("href");a.hasClass("child")&&void 0===app.tbcalling.row(a).data()&&(a=$(this).closest("tr").prev());a.data("key");var l=app.tbcalling.row(a).data();e.checkCounter()&&swal({title:"ยืนยัน END คิว "+l.q_num+" ?",text:l.pt_name,html:'<small class="text-danger" style="font-size: 13px;">กด Enter เพื่อยืนยัน / กด Esc เพื่อยกเลิก</small><p><i class="fa fa-user"></i>'+l.pt_name+"</p>",type:"question",showCancelButton:!0,confirmButtonText:"ยืนยัน",cancelButtonText:"ยกเลิก",allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(t,a){$.ajax({method:"POST",url:n+"&access-token="+accesstoken,dataType:"json",data:{data:l,...app.form},success:function(a){"200"==a.status?(e.reloadTbCalling(),e.toastrSuccess("END "+l.q_num),socket.emit("finish",a),t()):e.ajaxAlertWarning()},error:function(t,a,n){e.ajaxAlertError(n)}})})}}).then(e=>{e.value&&swal.close()})}),$("#tb-calling tbody").on("click","tr td a.btn-waiting",function(t){t.preventDefault();var a=$(this).closest("tr"),n=$(this).attr("href");a.hasClass("child")&&void 0===app.tbcalling.row(a).data()&&(a=$(this).closest("tr").prev());a.data("key");var l=app.tbcalling.row(a).data();e.checkCounter()&&swal({title:"ยืนยันส่งคิว "+l.q_num+" ?",text:l.pt_name,html:'<small class="text-danger" style="font-size: 13px;">กด Enter เพื่อยืนยัน / กด Esc เพื่อยกเลิก</small><p><i class="fa fa-user"></i>'+l.pt_name+"</p>",type:"question",showCancelButton:!0,confirmButtonText:"ยืนยัน",cancelButtonText:"ยกเลิก",allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(t,a){$.ajax({method:"POST",url:n+"&access-token="+accesstoken,dataType:"json",data:{data:l,...app.form},success:function(a){"200"==a.status?(e.reloadTbCalling(),e.toastrSuccess("END "+l.q_num),socket.emit("finish",a),t()):e.ajaxAlertWarning()},error:function(t,a,n){e.ajaxAlertError(n)}})})}}).then(e=>{e.value&&swal.close()})}),$("#tb-hold tbody").on("click","tr td a.btn-calling",function(t){t.preventDefault();var a=$(this).closest("tr"),n=$(this).attr("href");a.hasClass("child")&&void 0===app.tbhold.row(a).data()&&(a=$(this).closest("tr").prev());a.data("key");var l=app.tbhold.row(a).data(),o=$("#callingform-counter_service").select2("data")[0].text||"";e.checkCounter()&&swal({title:"ยืนยันเรียกคิว "+l.q_num+" ?",text:l.pt_name,html:'<small class="text-danger" style="font-size: 13px;">กด Enter เพื่อยืนยัน / กด Esc เพื่อยกเลิก</small><p>'+o+"</p>",type:"question",showCancelButton:!0,confirmButtonText:"เรียกคิว",cancelButtonText:"ยกเลิก",allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(t,a){$.ajax({method:"POST",url:n+"&access-token="+accesstoken,dataType:"json",data:{data:l,...app.form},success:function(a){200==a.status?(e.reloadTbCalling(),e.reloadTbHold(),e.toastrSuccess("CALL "+l.q_num),socket.emit("call",a),t()):e.ajaxAlertWarning()},error:function(t,a,n){e.ajaxAlertError(n)}})})}}).then(e=>{e.value&&swal.close()})}),$("#tb-hold tbody").on("click","tr td a.btn-end",function(t){t.preventDefault();var a=$(this).closest("tr"),n=$(this).attr("href");a.hasClass("child")&&void 0===app.tbhold.row(a).data()&&(a=$(this).closest("tr").prev());a.data("key");var l=app.tbhold.row(a).data();e.checkCounter()&&swal({title:"ยืนยัน END คิว "+l.q_num+" ?",text:l.pt_name,html:'<small class="text-danger" style="font-size: 13px;">กด Enter เพื่อยืนยัน / กด Esc เพื่อยกเลิก</small>',type:"question",showCancelButton:!0,confirmButtonText:"ยืนยัน",cancelButtonText:"ยกเลิก",allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(t,a){$.ajax({method:"POST",url:n+"&access-token="+accesstoken,dataType:"json",data:{data:l,...app.form},success:function(a){200==a.status?(e.reloadTbCalling(),e.reloadTbHold(),e.toastrSuccess("END "+l.q_num),socket.emit("finish",a),t()):e.ajaxAlertWarning()},error:function(t,a,n){e.ajaxAlertError(n)}})})}}).then(e=>{e.value&&swal.close()})}),$("#tb-patients-ist tbody").on("click","tr td a",function(e){e.preventDefault();var t=$("#tb-patients-ist").DataTable(),a=$(this).closest("tr"),n=$(this).attr("data-key"),l=$(this).attr("data-group");a.hasClass("child")&&void 0===t.row(a).data()&&(a=$(this).closest("tr").prev());a.data("key");var o=t.row(a).data(),r=$(this).text();swal({title:"ยืนยัน?",text:o.fullname,html:'<small class="text-danger" style="font-size: 13px;">กด Enter เพื่อยืนยัน / กด Esc เพื่อยกเลิก</small><p><i class="fa fa-user"></i>'+o.fullname+'</p><p><i class="fa fa-angle-double-down"></i></p><p>'+r+"</p>",type:"question",showCancelButton:!0,confirmButtonText:"Confirm",showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(e){$.ajax({url:baseUrl+"/app/kiosk/register",type:"POST",data:$.extend(o,{groupid:l,serviceid:n}),dataType:"JSON",success:function(a){"200"==a.status?(toastr.success(a.modelQ.pt_name,"Printing #"+a.modelQ.q_num,{timeOut:3e3,positionClass:"toast-top-right"}),window.open(a.url,"myPrint","width=800, height=600"),t.ajax.reload(),dt_tbqdata.ajax.reload(),socket.emit("register",a),e()):swal("Oops...","เกิดข้อผิดพลาด!","error")},error:function(e,t){swal("Oops...",t,"error")}})})}}).then(e=>{e.value&&swal.close()})})},init:function(){var e=this;e.handleEventClick()},reloadTbWaiting:function(){app.tbwaiting&&!app.waitingLoading&&app.tbwaiting.ajax.reload()},reloadTbCalling:function(){app.tbcalling&&!app.callingLoading&&app.tbcalling.ajax.reload()},reloadTbHold:function(){app.tbhold&&!app.holdLoading&&app.tbhold.ajax.reload()},toastrSuccess:function(e=""){"on"==localStorage.getItem("disablealert-pagecalling")&&toastr.success(e,"Success!",{timeOut:3e3,positionClass:"toast-top-right",progressBar:!0,closeButton:!0})},toastrWarning:function(e="Warning!",t=""){"on"==localStorage.getItem("disablealert-pagecalling")&&toastr.success(t,e,{timeOut:5e3,positionClass:"toast-top-right",progressBar:!0,closeButton:!0})},ajaxAlertError:function(e){swal({type:"error",title:e,showConfirmButton:!1,timer:1500})},ajaxAlertWarning:function(){swal({type:"error",title:"เกิดข้อผิดพลาด!!",showConfirmButton:!1,timer:1500})},checkCounter:function(){if(null==app.form.service_profile_id||null==app.form.counter_service_id){var e=null==app.form.service_profile_id?"กรุณาเลือกโปรไฟล์":"กรุณาเลือกช่องบริการ";return swal({type:"warning",title:e,showConfirmButton:!1,timer:1500}),!1}return!0}},$(function(){socket.on("register",e=>{var t=String(_.get(app.modelServiceProfile,"service_id")).split(",");if(dt_tbqdata.ajax.reload(),-1!=jQuery.inArray(e.modelQueue.serviceid.toString(),t)){if("on"==localStorage.getItem("playsound-pagecalling")){$("#jplayer_notify").jPlayer({ready:function(){$(this).jPlayer("setMedia",{mp3:"/media/alert.mp3"}).jPlayer("play")},supplied:"mp3",ended:function(){$(this).jPlayer("stop")}});$("#jplayer_notify").jPlayer("play")}Queue.reloadTbWaiting(),toastr.warning(e.modelQueue.q_num,"คิวใหม่!",{timeOut:7e3,positionClass:"toast-top-right",progressBar:!0,closeButton:!0})}}).on("call",e=>{var t=app.tbwaiting,a=app.tbcalling,n=app.tbhold;t.rows().every(function(t,a,n){var l=this.data();parseInt(l.q_ids)!==parseInt(_.get(e,"modelQueue.q_ids"))&&parseInt(l.q_ids)!==parseInt(_.get(e,"modelQ.q_ids"))||(Queue.reloadTbWaiting(),Queue.reloadTbCalling(),dt_tbqdata.ajax.reload())}),a.rows().every(function(t,a,n){var l=this.data();parseInt(l.caller_ids)!==parseInt(_.get(e,"modelCaller.caller_ids"))&&parseInt(l.caller_ids)!==parseInt(_.get(e,"model.caller_ids"))||(Queue.reloadTbCalling(),dt_tbqdata.ajax.reload())}),n.rows().every(function(t,a,n){var l=this.data();parseInt(l.caller_ids)!==parseInt(_.get(e,"modelCaller.caller_ids"))&&parseInt(l.caller_ids)!==parseInt(_.get(e,"model.caller_ids"))||(Queue.reloadTbHold(),Queue.reloadTbCalling(),dt_tbqdata.ajax.reload())})}).on("hold",e=>{var t=app.tbcalling,a=app.tbhold;t.rows().every(function(t,a,n){var l=this.data();parseInt(l.caller_ids)!==parseInt(_.get(e,"modelCaller.caller_ids"))&&parseInt(l.caller_ids)!==parseInt(_.get(e,"model.caller_ids"))||(Queue.reloadTbCalling(),Queue.reloadTbHold(),dt_tbqdata.ajax.reload())}),a.rows().every(function(t,a,n){var l=this.data();parseInt(l.caller_ids)!==parseInt(_.get(e,"modelCaller.caller_ids"))&&parseInt(l.caller_ids)!==parseInt(_.get(e,"model.caller_ids"))||(Queue.reloadTbCalling(),Queue.reloadTbHold(),dt_tbqdata.ajax.reload())})}).on("finish",e=>{var t=app.tbcalling,a=app.tbhold,n=String(_.get(app.modelServiceProfile,"service_id")).split(",");-1!=jQuery.inArray(e.modelQueue.serviceid.toString(),n)&&Queue.reloadTbWaiting(),t.rows().every(function(t,a,n){var l=this.data();parseInt(l.caller_ids)!==parseInt(_.get(e,"modelCaller.caller_ids"))&&parseInt(l.caller_ids)!==parseInt(_.get(e,"model.caller_ids"))||(Queue.reloadTbCalling(),Queue.reloadTbHold(),dt_tbqdata.ajax.reload())}),a.rows().every(function(t,a,n){var l=this.data();parseInt(l.caller_ids)!==parseInt(_.get(e,"modelCaller.caller_ids"))&&parseInt(l.caller_ids)!==parseInt(_.get(e,"model.caller_ids"))||(Queue.reloadTbCalling(),Queue.reloadTbHold(),dt_tbqdata.ajax.reload())})}).on("display",e=>{setTimeout(function(){app.tbcalling.rows().every(function(t,a,n){var l=this.data();l.q_num==e.title&&($("#tb-calling").find("tr.success").removeClass("success"),$("#last-queue").html(l.q_num),app.tbcalling.$("tr#"+e.artist.data.DT_RowId).addClass("success"),Queue.toastrWarning("",'<i class="pe-7s-speaker"></i> กำลังเรียกคิว #'+l.q_num))})},500)}),$("#callingform-qnum").keyup(function(){this.value=this.value.toUpperCase()})});var $form=$("#calling-form");$form.on("beforeSubmit",function(){var e,t={},a=$("#callingform-counter_service").select2("data")[0].text||"";return $form.serializeArray().map(function(e){t[e.name]=e.value}),null!=t["CallingForm[qnum]"]&&""!=t["CallingForm[qnum]"]?(app.tbcalling.rows().every(function(a,n,l){var o=this.data();o.q_num===t["CallingForm[qnum]"]&&(e={data:o,tbkey:"tbcalling"})}),app.tbwaiting.rows().every(function(a,n,l){var o=this.data();o.q_num===t["CallingForm[qnum]"]&&(e={data:o,tbkey:"tbwaiting"})}),app.tbhold.rows().every(function(a,n,l){var o=this.data();o.q_num===t["CallingForm[qnum]"]&&(e={data:o,tbkey:"tbhold"})}),void 0===e?toastr.error(t["CallingForm[qnum]"],"ไม่พบข้อมูล!",{timeOut:3e3,positionClass:"toast-top-center"}):"tbcalling"===e.tbkey?swal({title:"ยืนยันเรียกคิว "+e.data.q_num+" ?",text:"",html:'<small class="text-danger" style="font-size: 13px;">กด Enter เพื่อยืนยัน / กด Esc เพื่อยกเลิก</small><p>'+a+"</p>",type:"question",showCancelButton:!0,confirmButtonText:"เรียกคิว",cancelButtonText:"ยกเลิก",allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(t,a){$.ajax({method:"POST",url:`/node/api/v1/calling/recall?id=${e.data.caller_ids}&access-token=${accesstoken}`,dataType:"json",data:{data:e.data,...app.form},success:function(a){200==a.status?(Queue.reloadTbCalling(),Queue.toastrSuccess("RECALL "+e.data.q_num),socket.emit("call",a),t()):Queue.ajaxAlertWarning()},error:function(e,t,a){Queue.ajaxAlertError(a)}})})}}).then(e=>{e.value&&swal.close()}):"tbhold"===e.tbkey?swal({title:"ยืนยันเรียกคิว "+e.data.q_num+" ?",text:"",html:'<small class="text-danger" style="font-size: 13px;">กด Enter เพื่อยืนยัน / กด Esc เพื่อยกเลิก</small><p>'+a+"</p>",type:"question",showCancelButton:!0,confirmButtonText:"เรียกคิว",
cancelButtonText:"ยกเลิก",allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(t,a){$.ajax({method:"POST",url:`/node/api/v1/calling/recall?id=${e.data.caller_ids}&access-token=${accesstoken}`,dataType:"json",data:{data:e.data,...app.form},success:function(a){200==a.status?(Queue.reloadTbCalling(),Queue.reloadTbHold(),Queue.toastrSuccess("CALL "+e.data.q_num),socket.emit("call",a),t()):Queue.ajaxAlertWarning()},error:function(e,t,a){Queue.ajaxAlertError(a)}})})}}).then(e=>{e.value&&swal.close()}):"tbwaiting"===e.tbkey&&swal({title:"ยืนยันเรียกคิว "+e.data.q_num+" ?",text:"",html:'<small class="text-danger" style="font-size: 13px;">กด Enter เพื่อยืนยัน / กด Esc เพื่อยกเลิก</small><p>'+a+"</p>",type:"question",input:"radio",inputOptions:{0:"ต้องการ END ทันที",1:"ไม่ต้องการ END ทันที"},inputValue:1,showCancelButton:!0,confirmButtonText:"เรียกคิว",cancelButtonText:"ยกเลิก",allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(t){return new Promise(function(a,n){$.ajax({method:"POST",url:"/node/api/v1/calling/call?id="+e.data.q_ids+"&access-token="+accesstoken,dataType:"json",data:{data:e.data,...app.form},success:function(n){200==n.status?(Queue.reloadTbWaiting(),Queue.reloadTbCalling(),Queue.toastrSuccess("CALL "+e.data.q_num),socket.emit("call",n),0==t?setTimeout(function(){var e=$("#tb-calling tr#"+n.modelCaller.caller_ids),t="/node/api/v1/calling/end?id="+n.modelCaller.caller_ids+"&access-token="+accesstoken,l=(e.data("key"),app.tbcalling.row(e).data());$.ajax({method:"POST",url:baseUrl+t,dataType:"json",data:{data:l,...app.form},success:function(e){"200"==e.status?(Queue.reloadTbCalling(),Queue.toastrSuccess("END "+l.q_num),socket.emit("finish",e),a()):Queue.ajaxAlertWarning()},error:function(e,t,a){Queue.ajaxAlertError(a)}})},500):a()):Queue.ajaxAlertWarning()},error:function(e,t,a){Queue.ajaxAlertError(a)}})})}}).then(e=>{e.value&&swal.close()})):toastr.error(t["CallingForm[qnum]"],"ไม่พบข้อมูล!",{timeOut:3e3,positionClass:"toast-top-center"}),$("input#callingform-qnum").val(null),!1}),$("a.activity-callnext").on("click",function(e){e.preventDefault();var t=app.tbwaiting.rows(0).data(),a=($(this).attr("data-url"),$("#callingform-counter_service").select2("data")[0].text||"");t.length>0?Queue.checkCounter()&&swal({title:"CALL NEXT "+t[0].q_num+" ?",text:t[0].q_num,html:'<small class="text-danger" style="font-size: 13px;">กด Enter เพื่อยืนยัน / กด Esc เพื่อยกเลิก</small><p>'+a+"</p>",type:"question",input:"radio",inputOptions:{0:"ต้องการ END ทันที",1:"ไม่ต้องการ END ทันที"},inputValue:1,showCancelButton:!0,confirmButtonText:"เรียกคิว",cancelButtonText:"ยกเลิก",showLoaderOnConfirm:!0,preConfirm:function(e){return new Promise(function(a,n){$.ajax({method:"POST",url:"/node/api/v1/calling/call?id="+t[0].q_ids+"&access-token="+accesstoken,dataType:"json",data:{data:t[0],...app.form},success:function(n){200==n.status?($("li.tab-watting, #tab-watting").removeClass("active"),$("li.tab-calling, #tab-calling").addClass("active"),Queue.reloadTbWaiting(),Queue.reloadTbCalling(),Queue.toastrSuccess("CALL "+t[0].q_num),socket.emit("call",n),0==e?setTimeout(function(){var e=$("#tb-calling tr#"+n.modelCaller.caller_ids),t="/node/api/v1/calling/end?id="+n.modelCaller.caller_ids+"&access-token="+accesstoken,l=(e.data("key"),app.tbcalling.row(e).data());$.ajax({method:"POST",url:t,dataType:"json",data:{data:l,...app.form},success:function(e){"200"==e.status?(Queue.reloadTbCalling(),Queue.toastrSuccess("END "+e.modelQueue.q_num),socket.emit("finish",e),a()):Queue.ajaxAlertWarning()},error:function(e,t,a){Queue.ajaxAlertError(a)}})},500):a()):Queue.ajaxAlertWarning()},error:function(e,t,a){Queue.ajaxAlertError(a)}})})}}).then(e=>{e.value&&swal.close()}):swal({type:"warning",title:"ไม่พบหมายเลขคิว",showConfirmButton:!1,timer:1500})}),$("body").addClass("hide-sidebar"),$("#fullscreen-toggler").on("click",function(e){setFullScreen()}),$(document).ready(function(){$("#tablet-mode").on("click",function(){$(this).is(":checked")?localStorage.setItem("medical-tablet-mode","true"):localStorage.setItem("medical-tablet-mode","false"),setTabletmode()})}),setTabletmode(),$("#tb-waiting tbody").on("change",'input[name="selection[]"]',function(){var e=$(this).closest("tr"),t=$(this).val();this.checked?$(e).addClass("success"):$(e).removeClass("success"),this.checked?keySelected.push(t):-1!==jQuery.inArray(t,keySelected)&&$.each(keySelected,function(e,a){t==a&&keySelected.splice(e,1)}),keySelected.length>0?$("button.on-call-selected").prop("disabled",!1):$("button.on-call-selected").prop("disabled",!0),$(".count-selected").html("("+keySelected.length+")")}),$("button.on-call-selected").on("click",function(e){e.preventDefault();var t=$(this).data("url"),a=[],n=[];if($.each(keySelected,function(e,t){var l=app.tbwaiting.row("#"+t).data();null!=l&&(a.push(l),n.push(l.q_num))}),a.length>0&&Queue.checkCounter()){var l=$("#callingform-counter_service").select2("data")[0].text||"";swal({title:"ยืนยันเรียกคิว?",text:"",html:'<small class="text-danger" style="font-size: 13px;">กด Enter เพื่อยืนยัน / กด Esc เพื่อยกเลิก</small><br><p>'+n.join(", ")+"</p><p>"+l+"</p>",type:"question",input:"radio",inputOptions:{0:"ต้องการ END ทันที",1:"ไม่ต้องการ END ทันที"},inputValue:1,showCancelButton:!0,confirmButtonText:"เรียกคิว",cancelButtonText:"ยกเลิก",allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(e){return new Promise(function(n,l){var o=1e3;$.ajax({method:"POST",url:baseUrl+t,dataType:"json",data:{selectedData:a,...app.form,autoend:e},success:function(t){if($("li.tab-watting, #tab-watting").removeClass("active"),$("li.tab-calling, #tab-calling").addClass("active"),$(".count-selected").html("(0)"),$("button.on-call-selected").prop("disabled",!0),Queue.reloadTbWaiting(),Queue.reloadTbCalling(),$.each(t.call_result,function(e,t){setTimeout(function(){Queue.toastrSuccess("CALL "+t.data.q_num),socket.emit("call",t)},o),o+=1500}),0==e){var a=1e3;$.each(t.end_result,function(e,t){setTimeout(function(){Queue.toastrSuccess("END "+t.data.q_num),socket.emit("finish",t)},a),a+=1500})}keySelected=[],n()},error:function(e,t,a){Queue.ajaxAlertError(a)}})})}}).then(e=>{e.value})}}),Queue.init(),dt_tbqdata.on("xhr.dt",function(e,t,a,n){$("#count-qdata").html(_.get(a,"total",0))}),$("#tb-qdata tbody").on("click","tr td a.btn-del",function(e){e.preventDefault();var t=$(this).closest("tr"),a=$(this).attr("href");t.hasClass("child")&&void 0===dt_tbqdata.row(t).data()&&(t=$(this).closest("tr").prev());t.data("key");var n=dt_tbqdata.row(t).data();swal({title:"ยืนยันลบคิว "+n.q_num+" ?",text:"",type:"question",showCancelButton:!0,confirmButtonText:"ยืนยัน",cancelButtonText:"ยกเลิก",allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(e,t){$.ajax({method:"DELETE",url:a,dataType:"json",success:function(t){dt_tbqdata.ajax.reload(),Queue.toastrSuccess("ลบรายการคิวสำเร็จ"),e()},error:function(e,t,a){Queue.ajaxAlertError(a)}})})}}).then(e=>{e.value&&swal.close()})});